<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Bembel: H2Matrix</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="bembel_small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Bembel
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('group__H2Matrix.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">H2Matrix<div class="ingroups"><a class="el" href="group__Modules.html">Modules</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>The <a class="el" href="classH2Matrix.html" title="Hierarchical Matrix class, which extends the EigenBase class.">H2Matrix</a> module provides functionality for an efficient compression of the system matrix and reduction of the computational complexity of the matrix-vector multiplication.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structBembel_1_1H2Multipole_1_1ChebychevRoots.html">Bembel::H2Multipole::ChebychevRoots</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the number_of_points Chebychev points.  <a href="structBembel_1_1H2Multipole_1_1ChebychevRoots.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structBembel_1_1H2Multipole_1_1Moment1D.html">Bembel::H2Multipole::Moment1D&lt; InterpolationPoints, LinOp &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes 1D moment for FMM. All calculations ar performed on [0,1].  <a href="structBembel_1_1H2Multipole_1_1Moment1D.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structBembel_1_1H2Multipole_1_1Moment1DDerivative.html">Bembel::H2Multipole::Moment1DDerivative&lt; InterpolationPoints, LinOp &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes 1D moment for FMM using derivatives of the basis functions. All calculations ar performed on [0,1].  <a href="structBembel_1_1H2Multipole_1_1Moment1DDerivative.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structBembel_1_1H2Multipole_1_1Moment2D.html">Bembel::H2Multipole::Moment2D&lt; InterpolationPoints, LinOp &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes all 2D moment for the FMM by tensorisation of the 1D moments. Specialice this for your linear operator if you need derivatives on your local shape functions. See e.g. MaxwellSingleLayerOperator for an example.  <a href="structBembel_1_1H2Multipole_1_1Moment2D.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga4dafafe2155a1976f270f22ff35c5ea2"><td class="memTemplParams" colspan="2"><a id="ga4dafafe2155a1976f270f22ff35c5ea2"></a>
template&lt;typename Scalar &gt; </td></tr>
<tr class="memitem:ga4dafafe2155a1976f270f22ff35c5ea2"><td class="memTemplItemLeft" align="right" valign="top">Eigen::Matrix&lt; Scalar, Eigen::Dynamic, Eigen::Dynamic &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__H2Matrix.html#ga4dafafe2155a1976f270f22ff35c5ea2">Bembel::H2Multipole::backwardTransformation</a> (const Eigen::MatrixXd &amp;moment_matrices, const Eigen::MatrixXd &amp;transfer_matrices, const int steps, std::vector&lt; Eigen::Matrix&lt; Scalar, Eigen::Dynamic, Eigen::Dynamic &gt;&gt; &amp;long_dst_backward)</td></tr>
<tr class="memdesc:ga4dafafe2155a1976f270f22ff35c5ea2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Backward transformation for FMM. The content of long_dst_backward is destroyed. <br /></td></tr>
<tr class="separator:ga4dafafe2155a1976f270f22ff35c5ea2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0203377e94e1ce20cfdea64eeb049b60"><td class="memTemplParams" colspan="2"><a id="ga0203377e94e1ce20cfdea64eeb049b60"></a>
template&lt;typename InterpolationPoints &gt; </td></tr>
<tr class="memitem:ga0203377e94e1ce20cfdea64eeb049b60"><td class="memTemplItemLeft" align="right" valign="top">Eigen::MatrixXd&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__H2Matrix.html#ga0203377e94e1ce20cfdea64eeb049b60">Bembel::H2Multipole::computeLagrangePolynomials</a> (int number_of_points)</td></tr>
<tr class="memdesc:ga0203377e94e1ce20cfdea64eeb049b60"><td class="mdescLeft">&#160;</td><td class="mdescRight">computes the Lagrange polynomials wrt the interpolation points given by the InterpolationPoints struct wrt. Newton basis <br /></td></tr>
<tr class="separator:ga0203377e94e1ce20cfdea64eeb049b60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacde0a6d4057b3a1ec3d5bcaf57ff4eeb"><td class="memTemplParams" colspan="2">template&lt;typename InterpolationPoints &gt; </td></tr>
<tr class="memitem:gacde0a6d4057b3a1ec3d5bcaf57ff4eeb"><td class="memTemplItemLeft" align="right" valign="top">Eigen::MatrixXd&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__H2Matrix.html#gacde0a6d4057b3a1ec3d5bcaf57ff4eeb">Bembel::H2Multipole::computeTransferMatrices</a> (int number_of_points)</td></tr>
<tr class="memdesc:gacde0a6d4057b3a1ec3d5bcaf57ff4eeb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes transfer matrices in required order to apply them all-at-once in a matrix-vector-product, i.e. the order in the output is [T0 T2 T3 T1].  <a href="group__H2Matrix.html#gacde0a6d4057b3a1ec3d5bcaf57ff4eeb">More...</a><br /></td></tr>
<tr class="separator:gacde0a6d4057b3a1ec3d5bcaf57ff4eeb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7966b3bfc6ffff6848e8e4c088b25208"><td class="memTemplParams" colspan="2"><a id="ga7966b3bfc6ffff6848e8e4c088b25208"></a>
template&lt;typename InterpolationPoints &gt; </td></tr>
<tr class="memitem:ga7966b3bfc6ffff6848e8e4c088b25208"><td class="memTemplItemLeft" align="right" valign="top">double&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__H2Matrix.html#ga7966b3bfc6ffff6848e8e4c088b25208">Bembel::H2Multipole::evaluatePolynomial</a> (const Eigen::VectorXd &amp;L, double xi)</td></tr>
<tr class="memdesc:ga7966b3bfc6ffff6848e8e4c088b25208"><td class="mdescLeft">&#160;</td><td class="mdescRight">evaluates a given polynomial in the Newton basis wrt the interpolation points at a given location <br /></td></tr>
<tr class="separator:ga7966b3bfc6ffff6848e8e4c088b25208"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga57bfd4948c61dbfcd721d827335ea2b2"><td class="memTemplParams" colspan="2"><a id="ga57bfd4948c61dbfcd721d827335ea2b2"></a>
template&lt;typename Scalar &gt; </td></tr>
<tr class="memitem:ga57bfd4948c61dbfcd721d827335ea2b2"><td class="memTemplItemLeft" align="right" valign="top">std::vector&lt; Eigen::Matrix&lt; Scalar, Eigen::Dynamic, Eigen::Dynamic &gt; &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__H2Matrix.html#ga57bfd4948c61dbfcd721d827335ea2b2">Bembel::H2Multipole::forwardTransformation</a> (const Eigen::MatrixXd &amp;moment_matrices, const Eigen::MatrixXd &amp;transfer_matrices, const int steps, const Eigen::Matrix&lt; Scalar, Eigen::Dynamic, Eigen::Dynamic &gt; &amp;long_rhs_matrix)</td></tr>
<tr class="memdesc:ga57bfd4948c61dbfcd721d827335ea2b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Forward transformation for FMM. <br /></td></tr>
<tr class="separator:ga57bfd4948c61dbfcd721d827335ea2b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4915ea94de2db58772fd15d5acbc6699"><td class="memTemplParams" colspan="2"><a id="ga4915ea94de2db58772fd15d5acbc6699"></a>
template&lt;typename LinOp &gt; </td></tr>
<tr class="memitem:ga4915ea94de2db58772fd15d5acbc6699"><td class="memTemplItemLeft" align="right" valign="top">Eigen::Matrix&lt; typename <a class="el" href="structBembel_1_1LinearOperatorTraits.html">LinearOperatorTraits</a>&lt; LinOp &gt;::Scalar, Eigen::Dynamic, Eigen::Dynamic &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__H2Matrix.html#ga4915ea94de2db58772fd15d5acbc6699">Bembel::H2Multipole::interpolateKernel</a> (const LinOp &amp;linOp, const <a class="el" href="structBembel_1_1SuperSpace.html">SuperSpace</a>&lt; LinOp &gt; &amp;super_space, const Eigen::MatrixXd &amp;x, const <a class="el" href="classBembel_1_1ElementTreeNode.html">Bembel::ElementTreeNode</a> &amp;cluster1, const <a class="el" href="classBembel_1_1ElementTreeNode.html">Bembel::ElementTreeNode</a> &amp;cluster2)</td></tr>
<tr class="memdesc:ga4915ea94de2db58772fd15d5acbc6699"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interpolate kernel function on reference domain for FMM. <br /></td></tr>
<tr class="separator:ga4915ea94de2db58772fd15d5acbc6699"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga41fd2374858ae6bf7cbac5a7a5c2013a"><td class="memItemLeft" align="right" valign="top"><a id="ga41fd2374858ae6bf7cbac5a7a5c2013a"></a>
Eigen::MatrixXd&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__H2Matrix.html#ga41fd2374858ae6bf7cbac5a7a5c2013a">Bembel::H2Multipole::interpolationPoints2D</a> (const Eigen::VectorXd &amp;x)</td></tr>
<tr class="memdesc:ga41fd2374858ae6bf7cbac5a7a5c2013a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute tensor interpolation points on unit square from 1D interpolation points. <br /></td></tr>
<tr class="separator:ga41fd2374858ae6bf7cbac5a7a5c2013a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac08b2cd8d930efac4c5f9c836d3134d7"><td class="memTemplParams" colspan="2">template&lt;typename Mom1D_1 , typename Mom1D_2 , typename LinOp &gt; </td></tr>
<tr class="memitem:gac08b2cd8d930efac4c5f9c836d3134d7"><td class="memTemplItemLeft" align="right" valign="top">Eigen::MatrixXd&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__H2Matrix.html#gac08b2cd8d930efac4c5f9c836d3134d7">Bembel::H2Multipole::moment2DComputer</a> (const <a class="el" href="structBembel_1_1SuperSpace.html">SuperSpace</a>&lt; LinOp &gt; &amp;super_space, const int cluster_level, const int cluster_refinements, const int number_of_points)</td></tr>
<tr class="memdesc:gac08b2cd8d930efac4c5f9c836d3134d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes a single 2D moment for the FMM by tensorisation of the 1D moments.  <a href="group__H2Matrix.html#gac08b2cd8d930efac4c5f9c836d3134d7">More...</a><br /></td></tr>
<tr class="separator:gac08b2cd8d930efac4c5f9c836d3134d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>The <a class="el" href="classH2Matrix.html" title="Hierarchical Matrix class, which extends the EigenBase class.">H2Matrix</a> module provides functionality for an efficient compression of the system matrix and reduction of the computational complexity of the matrix-vector multiplication. </p>
<h2 class="groupheader">Function Documentation</h2>
<a id="gacde0a6d4057b3a1ec3d5bcaf57ff4eeb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gacde0a6d4057b3a1ec3d5bcaf57ff4eeb">&#9670;&nbsp;</a></span>computeTransferMatrices()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename InterpolationPoints &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">Eigen::MatrixXd Bembel::H2Multipole::computeTransferMatrices </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>number_of_points</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes transfer matrices in required order to apply them all-at-once in a matrix-vector-product, i.e. the order in the output is [T0 T2 T3 T1]. </p>
<p>initialize Lagrange polynomials and interpolation nodes</p>
<p>initialize values of Lagrange functions on the interpolation points as follows: E(:,0:npts-1) containes the values of the Lagrange polynomials on the interpolation points scaled to [0, 0.5]. E(:,npts:2*npts-1) containes the values of the Lagrange polynomials on the interpolation points scaled to [0.5, 1]. E(i,j) containes the value of the j.th polynomial on the ith point</p>

</div>
</div>
<a id="gac08b2cd8d930efac4c5f9c836d3134d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac08b2cd8d930efac4c5f9c836d3134d7">&#9670;&nbsp;</a></span>moment2DComputer()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Mom1D_1 , typename Mom1D_2 , typename LinOp &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">Eigen::MatrixXd Bembel::H2Multipole::moment2DComputer </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structBembel_1_1SuperSpace.html">SuperSpace</a>&lt; LinOp &gt; &amp;&#160;</td>
          <td class="paramname"><em>super_space</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>cluster_level</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>cluster_refinements</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>number_of_points</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes a single 2D moment for the FMM by tensorisation of the 1D moments. </p>
<p>Throughout this code we face the problem of memory serialisation for the traversel of elements in the element tree. the canonical orders would either be row major or column major traversal of a given patch resulting in e.g. element(i,j) = *(elementRoot + i * n + j) for n = 1 &lt;&lt; j. However, to achieve a localisation of matrix blocks if their corresponding shape functions are geometrically close, we typically use a hierarchical ordering of the elements. The mapping from hierarchical to row major ordering is easily facilitated by computing the elements position in its patch using its llc_. For our special situation of a balanced quadtree, this mapping is the same for every patch. In particular, the moments in our construction of the FMM only depend on the current level of uniform refinement and not on a particular patch. Next, we explicitly set up this mapping, where index_s determines the location of a given element along the first coordinate in the reference domain and index_t its second coordinate in the reference domain. Note that this piece of code only has to be used once in the entire setup of the FMM, such that the overhead is quite small.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Fri Jan 26 2024 09:26:06 for Bembel by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
